(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60],{8349:function(e,t,r){Promise.resolve().then(r.bind(r,5447))},5447:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var s=r(7437),n=r(2265),a=r(9376),i=r(2489),l=r(6858),c=r(5302);let o=(0,r(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var d=r(2141),u=r(7648);function h(){var e,t;let r=(0,a.useSearchParams)(),h=(0,a.useRouter)(),[x,m]=(0,n.useState)(!0),[f,g]=(0,n.useState)(null),[p,y]=(0,n.useState)("");return((0,n.useEffect)(()=>{(async()=>{try{let e=r.get("session_id");if(!e){y("Payment session not found"),m(!1);return}let{data:{user:t}}=await d.OQ.auth.getUser();if(!t){h.push("/login");return}let{data:s,error:n}=await d.OQ.from("purchases").select("*, prototypes(*)").eq("stripe_checkout_id",e).eq("buyer_id",t.id).single();if(n||!s){y("Purchase not found"),m(!1);return}"completed"!==s.status&&await d.OQ.from("purchases").update({status:"completed"}).eq("id",s.id),g(s)}catch(e){console.error(e),y("Error verifying purchase")}finally{m(!1)}})()},[r,h]),x)?(0,s.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 font-light",children:"Verifying your purchase..."})]})}):p?(0,s.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center px-4",children:(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-12 max-w-md w-full text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(i.Z,{className:"w-8 h-8 text-red-500"})}),(0,s.jsx)("h1",{className:"text-2xl font-light text-gray-900 mb-4",children:"Purchase Error"}),(0,s.jsx)("p",{className:"text-gray-600 font-light mb-8",children:p}),(0,s.jsxs)(u.default,{href:"/",className:"bg-gray-900 hover:bg-gray-800 text-white px-6 py-3 rounded-md font-light inline-flex items-center transition-colors group",children:[(0,s.jsx)("span",{children:"Back to Marketplace"}),(0,s.jsx)(l.Z,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center px-4",children:(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-12 max-w-2xl w-full",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-8",children:(0,s.jsx)(c.Z,{className:"w-12 h-12 text-gray-900"})}),(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-light text-gray-900 mb-4",children:"Purchase Successful"}),(0,s.jsx)("p",{className:"text-gray-600 font-light text-lg mb-2",children:"Thank you for your purchase"}),(0,s.jsxs)("p",{className:"text-gray-500 font-light",children:["You now have access to ",(0,s.jsx)("span",{className:"text-gray-900",children:null==f?void 0:null===(e=f.prototypes)||void 0===e?void 0:e.title})]})]}),(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-500 font-light mb-1",children:"Order ID"}),(0,s.jsx)("p",{className:"text-gray-900 font-mono",children:null==f?void 0:null===(t=f.id)||void 0===t?void 0:t.slice(0,8).toUpperCase()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-500 font-light mb-1",children:"Amount"}),(0,s.jsxs)("p",{className:"text-gray-900",children:["$",null==f?void 0:f.amount]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-500 font-light mb-1",children:"Status"}),(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-light bg-gray-900 text-white",children:"Completed"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-500 font-light mb-1",children:"Date"}),(0,s.jsx)("p",{className:"text-gray-900",children:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,s.jsxs)(u.default,{href:"/prototype/".concat(null==f?void 0:f.prototype_id),className:"bg-gray-900 hover:bg-gray-800 text-white px-6 py-3 rounded-md font-light inline-flex items-center justify-center transition-colors group",children:[(0,s.jsx)(o,{className:"w-4 h-4 mr-2"}),(0,s.jsx)("span",{children:"Download Prototype"})]}),(0,s.jsx)(u.default,{href:"/",className:"border border-gray-300 hover:border-gray-400 text-gray-700 px-6 py-3 rounded-md font-light inline-flex items-center justify-center transition-colors",children:(0,s.jsx)("span",{children:"Browse More"})})]}),(0,s.jsx)("p",{className:"text-center text-sm text-gray-500 font-light mt-8",children:"A receipt has been sent to your email address"})]})})}function x(){return(0,s.jsx)(n.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 font-light",children:"Loading..."})]})}),children:(0,s.jsx)(h,{})})}},2141:function(e,t,r){"use strict";r.d(t,{$O:function(){return a},OQ:function(){return s},cT:function(){return i},ts:function(){return n}});let s=(0,r(1545).eI)("https://your-production-project.supabase.co","your-production-anon-key");async function n(){let{data:{user:e}}=await s.auth.getUser();return e}async function a(e){let{data:t,error:r}=await s.from("prototypes").insert([e]).select().single();if(r)throw r;return t}async function i(e,t,r){let{data:n,error:a}=await s.storage.from(e).upload(t,r,{cacheControl:"3600",upsert:!1});if(a)throw a;return n}},6858:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},5302:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[972,263,971,117,744],function(){return e(e.s=8349)}),_N_E=e.O()}]);